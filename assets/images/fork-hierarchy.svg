<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 600 350">
  <defs>
    <linearGradient id="fhBg" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#0f172a"/>
      <stop offset="100%" style="stop-color:#1e293b"/>
    </linearGradient>
    <linearGradient id="fhPurple" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#7c3aed"/>
      <stop offset="100%" style="stop-color:#6d28d9"/>
    </linearGradient>
    <linearGradient id="fhBlue" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#3b82f6"/>
      <stop offset="100%" style="stop-color:#2563eb"/>
    </linearGradient>
    <linearGradient id="fhCyan" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#06b6d4"/>
      <stop offset="100%" style="stop-color:#0891b2"/>
    </linearGradient>
    <linearGradient id="fhGreen" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#10b981"/>
      <stop offset="100%" style="stop-color:#059669"/>
    </linearGradient>
    <linearGradient id="fhYellow" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#f59e0b"/>
      <stop offset="100%" style="stop-color:#d97706"/>
    </linearGradient>
    <filter id="fhShadow">
      <feDropShadow dx="0" dy="2" stdDeviation="4" flood-color="#000" flood-opacity="0.3"/>
    </filter>
  </defs>

  <!-- Background -->
  <rect width="600" height="350" fill="url(#fhBg)" rx="12"/>

  <!-- Title -->
  <text x="300" y="30" font-family="system-ui, sans-serif" font-size="16" font-weight="600" fill="#e2e8f0" text-anchor="middle">Execute Pipeline Fork Hierarchy</text>

  <!-- Level 1: /execute -->
  <g filter="url(#fhShadow)">
    <rect x="230" y="50" width="140" height="36" rx="6" fill="url(#fhPurple)"/>
    <text x="300" y="73" font-family="monospace" font-size="13" font-weight="bold" fill="white" text-anchor="middle">/execute</text>
    <circle cx="355" cy="68" r="8" fill="rgba(255,255,255,0.2)"/>
    <text x="355" y="72" font-family="system-ui, sans-serif" font-size="9" fill="white" text-anchor="middle">F</text>
  </g>

  <!-- Connection line -->
  <path d="M 300 86 L 300 110" stroke="#4ade80" stroke-width="2" fill="none"/>

  <!-- Level 2: execute-layer -->
  <g filter="url(#fhShadow)">
    <rect x="210" y="110" width="180" height="36" rx="6" fill="url(#fhBlue)"/>
    <text x="300" y="133" font-family="monospace" font-size="12" font-weight="500" fill="white" text-anchor="middle">execute-layer</text>
    <circle cx="375" cy="128" r="8" fill="rgba(255,255,255,0.2)"/>
    <text x="375" y="132" font-family="system-ui, sans-serif" font-size="9" fill="white" text-anchor="middle">F</text>
  </g>

  <!-- Connection line -->
  <path d="M 300 146 L 300 170" stroke="#4ade80" stroke-width="2" fill="none"/>

  <!-- Level 3: execute-batch -->
  <g filter="url(#fhShadow)">
    <rect x="210" y="170" width="180" height="36" rx="6" fill="url(#fhCyan)"/>
    <text x="300" y="193" font-family="monospace" font-size="12" font-weight="500" fill="white" text-anchor="middle">execute-batch</text>
    <circle cx="375" cy="188" r="8" fill="rgba(255,255,255,0.2)"/>
    <text x="375" y="192" font-family="system-ui, sans-serif" font-size="9" fill="white" text-anchor="middle">F</text>
  </g>

  <!-- Branch lines -->
  <path d="M 300 206 L 300 230 L 180 230 L 180 250" stroke="#4ade80" stroke-width="2" fill="none"/>
  <path d="M 300 230 L 420 230 L 420 250" stroke="#4ade80" stroke-width="2" fill="none"/>

  <!-- Level 4a: execute-task -->
  <g filter="url(#fhShadow)">
    <rect x="90" y="250" width="180" height="36" rx="6" fill="url(#fhGreen)"/>
    <text x="180" y="273" font-family="monospace" font-size="12" font-weight="500" fill="white" text-anchor="middle">execute-task</text>
    <circle cx="255" cy="268" r="8" fill="rgba(255,255,255,0.2)"/>
    <text x="255" y="272" font-family="system-ui, sans-serif" font-size="9" fill="white" text-anchor="middle">F</text>
  </g>

  <!-- Level 4b: execute-merge -->
  <g filter="url(#fhShadow)">
    <rect x="330" y="250" width="180" height="36" rx="6" fill="url(#fhYellow)"/>
    <text x="420" y="273" font-family="monospace" font-size="12" font-weight="500" fill="white" text-anchor="middle">execute-merge</text>
    <circle cx="495" cy="268" r="8" fill="rgba(255,255,255,0.2)"/>
    <text x="495" y="272" font-family="system-ui, sans-serif" font-size="9" fill="white" text-anchor="middle">F</text>
  </g>

  <!-- Connection line from task to verify -->
  <path d="M 180 286 L 180 310" stroke="#4ade80" stroke-width="2" fill="none"/>

  <!-- Level 5: execute-verify -->
  <g filter="url(#fhShadow)">
    <rect x="90" y="310" width="180" height="30" rx="6" fill="#374151" stroke="#6b7280" stroke-width="1"/>
    <text x="180" y="330" font-family="monospace" font-size="11" font-weight="500" fill="#d1d5db" text-anchor="middle">execute-verify</text>
    <circle cx="255" cy="325" r="8" fill="rgba(107,114,128,0.3)"/>
    <text x="255" y="329" font-family="system-ui, sans-serif" font-size="9" fill="#9ca3af" text-anchor="middle">F</text>
  </g>

  <!-- Legend -->
  <rect x="430" y="305" width="150" height="35" rx="6" fill="rgba(30,41,59,0.8)" stroke="#334155"/>
  <circle cx="450" cy="322" r="8" fill="rgba(124,58,237,0.3)"/>
  <text x="450" y="326" font-family="system-ui, sans-serif" font-size="9" fill="#a78bfa" text-anchor="middle">F</text>
  <text x="470" y="327" font-family="system-ui, sans-serif" font-size="11" fill="#94a3b8">= Fork (isolated context)</text>
</svg>
